<h1 class="p-4">Create Sheet</h1>

<div class="d-flex row pt-4 px-4">
    <div class="justify-content-start col">
        <div class="toggle-switch">
            <label class="toggle-switch-light">
                <input type="checkbox" (change)="selectSheet()">
                <span>
                    <span>Randomized Sheet</span>
                    <span>Customized Sheet</span>
                </span>
                <a class="btn btn-secondary"></a>
            </label>
        </div>
    </div>
</div>

<div *ngIf="randomizedSheet" class="px-4">
    <div style="margin-top: 15px;">
        <label>Title</label>
        <i class="bi bi-info-circle mx-4" title="This is the title of the sheet."></i>
        <input type="text" class="form-control" id="titleid" placeholder="Sheet title">
    </div>

    <div style="margin-top: 15px;">
        <label>Course</label>
        <i class="bi bi-info-circle mx-4" title="Choose the courses."></i>
        <ng-select [clearSearchOnAdd]="true" (change)="filterCategoriesChange($event)" [clearable]="false" [items]="categories"
                   [multiple]="true" bindLabel="categories" placeholder="Choose a course">
        </ng-select>
    </div>

    <div style="margin-top: 15px;">
        <label>Category</label>
        <i class="bi bi-info-circle mx-4" title="Choose the categories."></i>
        <ng-select id="categoriesid" [clearSearchOnAdd]="true" (change)="filterCategoriesChange($event)" [clearable]="false" [items]="categories"
                   [multiple]="true" bindLabel="name" placeholder="Choose a category">
        </ng-select>
    </div>

    <div style="margin-top: 15px;">
        <label>Number of Exercises</label>
        <i class="bi bi-info-circle mx-4" title="Choose the number of exercises."></i>
        <input type="text" class="form-control" id="number" placeholder="Sheet title">
    </div>

    <div class="text-center pt-4">
        <div class="form-group text-center">
            <button type="submit" class="btn btn-primary me-3" routerLink="/sheet/db">
                Compile and download
            </button>
            <button *ngIf="isProfessor" type="submit" class="btn btn-primary me-3" routerLink="/sheet/db">
                Compile and save
            </button>
        </div>
    </div>
</div>

<div *ngIf="!randomizedSheet" class="px-4" >
    <div style="margin-top: 15px;">
        <label>Title</label>
        <i class="bi bi-info-circle mx-4" title="This is the title of the sheet."></i>
        <input type="text" class="form-control" id="title" placeholder="Sheet title">
    </div>

    <div style="margin-top: 15px;">
        <label>Course</label>
        <i class="bi bi-info-circle mx-4" title="Choose courses to filter the listed exercises."></i>
        <ng-select id="course" [clearSearchOnAdd]="true" (change)="filterCoursesChange($event)" [clearable]="false" [items]="courses"
                   [multiple]="true" bindLabel="name" placeholder="Filter by course">
        </ng-select>
    </div>

    <div style="margin-top: 15px;">
        <label>Category</label>
        <i class="bi bi-info-circle mx-4" title="Choose categories to filter the listed exercises."></i>
        <ng-select id="category" [clearSearchOnAdd]="true" (change)="filterCategoriesChange($event)" [clearable]="false" [items]="categories"
                   [multiple]="true" bindLabel="name" placeholder="Filter by category">
        </ng-select>
    </div>

    <div style="margin-top: 15px;">
        <label>Select Exercises</label>
        <i class="bi bi-info-circle mx-4" title="Choose exercises for the sheet."></i>
        <table class="table table-striped" *ngIf="filteredExercises.length">
            <thead>
            <tr>
                <th scope="col" class="col-1"> Select </th>
                <th scope="col" class="col-2"> Title </th>
                <th scope="col" class="col-2"> Course </th>
                <th scope="col" class="col-2"> Category </th>
                <th scope="col" class="col-2"> Short Description </th>
                <th scope="col" class="col-2" *ngIf="isProfessor"> Notes </th>
                <th scope="col" class="col-1" *ngIf="isProfessor"> Is used </th>
                <th scope="col" class="col-1"> </th>

            </tr>
            </thead>
            <tbody>
                <tr *ngFor="let exercise of filteredExercises | slice: (page-1) * pageSize : (page-1) * pageSize + pageSize;">

                    <td scope="row"><input class="form-check-input" type="checkbox"></td>
                    <td scope="row">{{ exercise.title }}</td>
                    <td scope="row">{{ getExerciseCourses(exercise.courses) }} </td>
                    <td scope="row">{{ getExerciseCategories(exercise.categories) }} </td>
                    <td scope="row">{{ exercise.shortDescription }} </td>
                    <td scope="row" *ngIf="isProfessor"> {{ exercise.note }} </td>
                    <td scope="row" *ngIf="isProfessor"><input class="form-check-input" type="checkbox"></td>

                    <td scope="row">
                        <button type="submit" class="btn btn-success btn-sm"
                                (click)="viewSheetPdf(exercise.id)">
                            <i class="bi bi-eye text-white"></i>
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="row ">
            <div class="col-4 ">
                <select class="form-select" style="width:200px" [ngModel]="pageSize" (ngModelChange)="setPageSize($event)">
                    <option [ngValue]="5">5 items per page</option>
                    <option [ngValue]="10">10 items per page</option>
                    <option [ngValue]="25">25 items per page</option>
                    <option [ngValue]="50">50 items per page</option>
                </select>
            </div>
            <div class="col-4  d-flex justify-content-around">
                <ngb-pagination [collectionSize]="exercises.length" [(page)]="page" [pageSize]="pageSize"
                                [boundaryLinks]="true" [maxSize]="5" [ellipses]="true">
                </ngb-pagination>
            </div>
        </div>
        <div *ngIf="!filteredExercises.length" class="px-4 center no-data-found-text">
            No exercises found.
        </div>
    </div>

    <div class="text-center pt-4">
        <div class="form-group text-center">
            <button type="submit" class="btn btn-primary me-3" routerLink="/sheet/db">
                Compile and download
            </button>
            <button *ngIf="isProfessor" type="submit" class="btn btn-primary me-3" routerLink="/sheet/db">
                Compile and save
            </button>
        </div>
    </div>
</div>
